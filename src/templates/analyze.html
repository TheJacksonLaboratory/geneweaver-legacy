{% set title="Analyze Genesets" %}
{% include 'header.html' %}
{% import 'macros.html' as macros %}

<div class="page-header">
    <h1>{{ title }}</h1>
</div>

<form id="todo-id" class="form-horizontal" role="form" method="post">
    <div class="row">

        <!-- the Analysis tools column -->
        <div class="col-md-4">
            <div class="page-header"><h2>Analysis Tools</h2></div>

            {% for tool in active_tools %}
                {% include 'tool/' + tool.classname + '_options.html' %}
            {% endfor %}
        </div>

        <!-- the projects column -->
        <div class="col-md-8">
            <div class="page-header"><h2>Projects</h2></div>

            {#
            TODO this should be changed to use JSON to fetch data for project panels when they are expanded
            (for users with many projects the current version is too slow)
            #}
            {% if "user" in g %}
                {% for proj in g.user.projects %}
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <input style="margin: 5px;" onclick=";" value="" type="checkbox">
                                <a data-toggle="collapse" href="#collapse-{{ proj.project_id }}">
                                    <span class="glyphicon glyphicon-plus"></span>
                                    {{ proj.name }}
                                </a>
                            </h4>
                        </div>
                        <div id="collapse-{{ proj.project_id }}" class="panel-collapse collapse">
                            <div class="panel-body">
                                <table class="table table-hover">
                                    <tbody>
                                    {% for geneset in proj.get_genesets(g.user.user_id) %}
                                        <tr><td><label><input type="checkbox" name="geneset_{{ geneset.geneset_id }}" value="1"> {{ geneset.name }}</label></td></tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% endif %}
        </div>
    </div>
</form>

{% include 'footer.html' %}
