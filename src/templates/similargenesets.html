{% set title="Similar Genesets" %}
{% include 'header.html' %}
{% import 'macros.html' as macros %}


    <div class="row" id="result"></div>

    <div class="panel panel-default panel-heading bg-gray-light">
        <h2 class="panel-title"><strong>View Similar Genesets</strong></h2>
    </div>



    <div class="panel panel-default">
    <div class="panel-heading" style="border-bottom-width: thick; border-bottom-color: #006400;">
        <h3 class="panel-title">
            {% if geneset.cur_id == 1 %}
                <span class="tier1" style="vertical-align: middle">Tier I</span>
            {% endif %}
            {% if geneset.cur_id == 2 %}
                <span class="tier2" style="vertical-align: middle">Tier II</span>
            {% endif %}
            {% if geneset.cur_id == 3 %}
                <span class="tier3" style="vertical-align: middle">Tier III</span>
            {% endif %}
            {% if geneset.cur_id == 4 %}
                <span class="tier4" style="vertical-align: middle">Tier IV</span>
            {% endif %}
            {% if geneset.cur_id == 5 %}
                <span class="tier5" style="vertical-align: middle">Tier V</span>
            {% endif %}
            GS{{ geneset.geneset_id }} - {{ geneset.name }}</h3>
    </div>

    <div class="panel-body">
    <div class="row">
        <div class="col-md-5">
            <a href="/viewgenesetdetails/{{ gs_id }}">
            <b><i class="fa fa-step-backward"></i> Return to Geneset Details</b></a>
        </div><br>
        <div class="col-xs-12 col-md-9">

            <div class="row">
                <div class="col-md-2">
                    <p class="text-right"><strong>DESCRIPTION:</strong></p>
                </div>
                <div class="col-md-10">
                    <p>{{ geneset.description }}</p>
                </div>
            </div>

            <div class="row">
                <div class="col-md-2">
                    <p class="text-right"><strong>LABEL:</strong></p>
                </div>
                <div class="col-md-10">
                    <p>{{ geneset.abbreviation }}</p>
                </div>
            </div>

            <div class="row">
                <div class="col-md-2">
                    <p class="text-right"><strong>SPECIES:</strong></p>
                </div>
                <div class="col-md-10">
                    {% if geneset.sp_id == 1 %}
                        <span class="mouse">Mouse</span>
                    {% endif %}
                    {% if geneset.sp_id == 2 %}
                        <span class="human">Human</span>
                    {% endif %}
                    {% if geneset.sp_id == 3 %}
                        <span class="rat">Rat</span>
                    {% endif %}
                    {% if geneset.sp_id == 4 %}
                        <span class="zebrafish">Zebrafish</span>
                    {% endif %}
                    {% if geneset.sp_id == 5 %}
                        <span class="fly">Fly</span>
                    {% endif %}
                    {% if geneset.sp_id == 6 %}
                        <span class="monkey">Monkey</span>
                    {% endif %}
                </div>
            </div>

            {# Right Side List of Buttons #}

        </div>
        <div class="col-xs-6 col-md-3">
            <button type="button" class="btn btn-lg btn-block btn-warning" id="exportData">
                <i class="fa fa-download pull-left"></i> Export Genes
            </button>
            {% if order == 'tier' %}
            <button type="button" class="btn btn-lg btn-block btn-warning" id="orderbySpecies">
                <i class="fa fa-refresh pull-left"></i> Order by Species
            </button>
            {% else %}
            <button type="button" class="btn btn-lg btn-block btn-warning" id="orderbyTier">
                <i class="fa fa-refresh pull-left"></i> Order by Tier
            </button>
            {% endif %}
            <button type="button" class="btn btn-lg btn-block btn-warning" id="addToProject">
                <i class="fa fa-folder-o pull-left"></i> Add to Project
            </button>

        </div>

    </div>


</div>

    <!-- Show the Geneset List -->
    <div class="panel panel-default">
        <div class="panel-heading" style="border-bottom-width: thick; border-bottom-color: #006400;">
            <h3 class="panel-title">Gene List</h3>
        </div>
        <div class="panel-body">
            <!-- TODO make the table sortable, show more gene details -->
            <table class="table table-hover">
                <tbody>
                <tr>
                    <th>Gene Symbol</th>
                    <th>LinkOuts</th>
                    <th>Data Value</th>
                    <th>Emphasis</th>
                </tr>

                {% for geneset_value in geneset.geneset_values %}
                    <tr>
                        <td>
                            <!-- TODO Determine how to show gene with multiple sources listed -->
                            <a href="/search/?searchbar={{ geneset_value.source_list[0] }}&pagination_page=1&searchGenes=yes">{{ geneset_value.source_list[0] }}</a>
                        </td>
                        <td>
                            <!-- TODO Insert outside links here -->
                            {% set gene=geneset_value.source_list[0] %}
                            {% include 'linkouts.html' %}
                        </td>
                        <td>
                            {{ geneset_value.value }}
                        </td>
                        <td>
                            <input type="checkbox" name="g_id[]" id="{{ geneset_value.ode_gene_id }}"
                                   onclick="emphasize('{{ geneset_value.ode_gene_id }}');" class="table-checkbox"/>
                        </td>
                    </tr>
                {% endfor %}

                </tbody>
            </table>
        </div>
    </div>

    {% for gene in emphgeneids %}
        <script>
            document.getElementById("{{gene}}").checked = true;
        </script>
    {% endfor %}

    <!-- <body onload="myFunction()"> -->

    <script type="text/javascript">
        function emphasize(id) {
            if (document.getElementById(id).checked) {
                $.get("/emphasize/" + id + ".html", function (data, status) {
                });
            }
            else {
                $.get("/deemphasize/" + id + ".html", function (data, status) {
                });
            }
        }

        $(document).ready(function () {
            var gs_id = {{ geneset.geneset_id }};
            $('#exportData').on('click', function (e) {
                window.open('../exportGeneList/' + gs_id);
            });

            $('#viewSimilarGenesets').on('click', function (e){

                window.open('../viewSimilarGenesets/' + gs_id, "_self");
            });

            });
        //});


    </script>


{% include 'footer.html' %}
