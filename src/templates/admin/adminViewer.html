
{% extends 'admin/AdminTemplateOverride.html' %}

{% block body %}
<!--<script type="text/javascript" src="{{ url_for('static', filename='js/jquery-1.11.1.min.js') }}"></script>-->

<script id=viewer>
    $(document).ready(function()  {        
	 var table = '{{table}}';
	 var columns = {{jcolumns | safe}};
	 var editRoute="../../admin/adminEdit/" + table;

	String.prototype.capitalize = function() {
    	    return this.charAt(0).toUpperCase() + this.slice(1);
	}

	var lastIdx = null;
          
        var table = $('#adminViewer').dataTable( {
            "processing": true,
            "serverSide": true,
            "ajax": {
                    'url': "../../admin/serversidedb",
                    'type': 'GET',
		    "data": {"table": table}
                },
	    "columns": columns,
	    /*"aoColumnDefs" : [ 
                    {
                        "aTargets": [0],	
                        "fnCreatedCell" : function(nTd, sData, oData, iRow, iCol){
                            var b = $('<button style="margin: 0">edit</button>');
                            b.button();
                            b.on('click',function(){
                                document.location.href = oData[0];
                                return false;
                            });
                            $(nTd).empty();
                            $(nTd).prepend(b);
                        }
		     }
                    ],*/
	   /* "fnRowCallback": function( nRow, aData, iDisplayIndex ) {
                $('td:eq(0)', nRow).html('<a href='+nRow+'>' +  aData[0] + '</a>');
                return nRow;
        },*/    	    
        });

	$('#adminViewer td').live('click', function() {
    		var anOpen = [];
    		var nTr = this.parentNode;
    		var i = $.inArray(nTr, anOpen);
		var data = [];
		data.push('{{table}}');
		j=0;
    		$(this).parent().find("td").each(function() {
        	    data.push(columns[j]["name"]+'=\''+$(this).html()+'\''); // logs each cell value 
		    j++;
		});
		//alert(data)
   		window.location = "/admin/adminEdit/"+data;
 	});
    });
</script>


<h3 align=left>{{table.split(".")[1].replace("_"," ").capitalize()}}</h3>

<div class="btn-group">
  <button type="button" onclick="window.location.href = '../../admin/{{route}}'" route class="btn btn-default">Add New Group</button>
</div>
<p>

<div class="table-responsive">
  <table id="adminViewer" style="2" class="table table-striped" table border="1">  
    <thead>
      <tr>
	{% for col in columns %}
	    <th style="text-align: left">{{col.name.replace("_"," ").capitalize()}}</th>
	{% endfor %}
      </tr>	
    </thead>
    <tfoot>       
      <tr>
	{% for col in columns %}
	    <th style="text-align: left">{{col.name.replace("_"," ").capitalize()}}</th>
	{% endfor %}
      </tr>
  </tfoot>
  </table>
</div>

{% endblock %} 
